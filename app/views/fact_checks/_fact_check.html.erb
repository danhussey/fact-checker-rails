<%= turbo_frame_tag dom_id(fact_check) do %>
  <article class="bg-zinc-900 rounded-xl p-4 border border-zinc-800">
    <div class="flex justify-between items-start gap-4">
      <p class="text-white font-medium flex-1"><%= fact_check.claim %></p>

      <% if fact_check.completed? %>
        <%= render "fact_checks/verdict_badge", fact_check: fact_check %>
      <% elsif fact_check.processing? %>
        <span class="px-3 py-1 rounded-full bg-zinc-700 text-zinc-400 text-sm animate-pulse">
          Checking...
        </span>
      <% elsif fact_check.failed? %>
        <span class="px-3 py-1 rounded-full bg-red-900/50 text-red-400 text-sm">
          ERROR
        </span>
      <% else %>
        <span class="px-3 py-1 rounded-full bg-zinc-800 text-zinc-500 text-sm">
          Pending
        </span>
      <% end %>
    </div>

    <% if fact_check.completed? %>
      <details class="mt-3">
        <summary class="text-zinc-500 text-sm cursor-pointer hover:text-zinc-400">
          Details
          <% if fact_check.whats_true&.any? %><span class="text-green-500 ml-2">✓<%= fact_check.whats_true.size %></span><% end %>
          <% if fact_check.whats_wrong&.any? %><span class="text-red-500 ml-1">✗<%= fact_check.whats_wrong.size %></span><% end %>
          <% if fact_check.context_points&.any? %><span class="text-blue-500 ml-1">+<%= fact_check.context_points.size %></span><% end %>
        </summary>

        <div class="mt-3 space-y-3">
          <% if fact_check.whats_true&.any? %>
            <div class="bg-green-950/30 border border-green-900/50 rounded-lg p-3">
              <h4 class="text-green-400 text-sm font-medium mb-2">What's True</h4>
              <ul class="text-green-200/80 text-sm space-y-1">
                <% fact_check.whats_true.each do |item| %>
                  <li>• <%= item %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

          <% if fact_check.whats_wrong&.any? %>
            <div class="bg-red-950/30 border border-red-900/50 rounded-lg p-3">
              <h4 class="text-red-400 text-sm font-medium mb-2">What's Wrong</h4>
              <ul class="text-red-200/80 text-sm space-y-1">
                <% fact_check.whats_wrong.each do |item| %>
                  <li>• <%= item %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

          <% if fact_check.context_points&.any? %>
            <div class="bg-blue-950/30 border border-blue-900/50 rounded-lg p-3">
              <h4 class="text-blue-400 text-sm font-medium mb-2">Context</h4>
              <ul class="text-blue-200/80 text-sm space-y-1">
                <% fact_check.context_points.each do |item| %>
                  <li>• <%= item %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

          <% if fact_check.sources&.any? %>
            <div class="flex flex-wrap gap-2">
              <% fact_check.sources.each do |source| %>
                <% if source["url"].present? %>
                  <%= link_to source["name"], source["url"],
                      target: "_blank",
                      rel: "noopener",
                      class: "px-2 py-1 bg-zinc-800 text-zinc-400 text-xs rounded hover:bg-zinc-700" %>
                <% else %>
                  <span class="px-2 py-1 bg-zinc-800 text-zinc-400 text-xs rounded">
                    <%= source["name"] %>
                  </span>
                <% end %>
              <% end %>
            </div>
          <% end %>
        </div>
      </details>
    <% end %>

    <p class="text-zinc-600 text-xs mt-2"><%= time_ago_in_words(fact_check.created_at) %> ago</p>
  </article>
<% end %>
